<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="../css/map_view.css">
    <link rel="stylesheet" type="text/css" href="../css/route_view.css">
    <link rel="stylesheet" type="text/css" href="./css/trip_view.css">
    <link rel="stylesheet" type="text/css" href="./css/calendar_view.css">
    <link rel="stylesheet" type="text/css" href="./css/glyph_legend.css">
    <script type="text/javascript" src="../jQuery/jquery-2.0.3.min.js"></script>
</head>

<body>
    <div id="map_id"></div>
    <input type="text" id="search_box"></input>
    <button id="search_button">Search</button>
    <div id="route_id"></div>
    <button onclick="clearSubview()">Clear</button>
    <button onclick="switchToTripView()">Trip View</button>
    <button onclick="switchToStopView()">Stop View</button>
    <div id="calendar-container">
        <h3 id="date">
        </h3>
    </div>
    <div id="subview-container"></div>
</body>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="../d3.v3/d3.v3.js"></script>
<script type="text/javascript" src="../js/map_view.js"></script>
<script type="text/javascript" src="../js/route_view.js"></script>
<script type="text/javascript" src="./js/calendar_view.js"></script>
<script type="text/javascript" src="./js/trip_view.js"></script>
<script type="text/javascript" src="../src/glyphs.js"></script>
<script type="text/javascript" src="../lib/chartjs/chart.js"></script>

<script>
$('#search_box').keydown(function(e) {
    if (e.keyCode == 13) {
        search_highlight();
        return false;
    }
});
$("#search_button").click(function() {
    search_highlight();
    return false;
});

function search_highlight() {
    var text = $("#search_box").val();
    map_highlightStops([text]);
    api_highlight_given_name(text);
}
</script>
<script>
    //displayCalendar(fake_cal_data, updateTripView);
    var clearSubview = function () {
        $("#subview-container").empty();
    };

    displayCalendar(fake_cal_data, function (d) {
        $("#date").text(d[0].date.toDateString());
        updateTripView(d, "#subview-container");
        //individual_bar_all(d, 500, 200, "subview-container");
    });

    var switchToTripView = function () {
        clearSubview();
        //$("#subview-container").text("Trip View");
        changeSubviewUpdate(function (d) {
            $("#date").text(d[0].date.toDateString());
            updateTripView(d, "#subview-container");
        });
    };

    var switchToStopView = function () {
        clearSubview();
        
        $("#subview-container").append("<div id='legend'>"
        + "<span id='early'>Average earlyness (minutes)</span> "
        + "<span id='late'>Average lateness (minutes)</span> "
        + "<span id='boarded'>Average boarded (farecount)</span></div>");
        
        changeSubviewUpdate(function (d) {
            $("#date").text(d[0].date.toDateString());
            aggregate_bar_all(d, 500, 320, "subview-container");
        });
    };
</script>


</html>
