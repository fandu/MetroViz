\documentclass[journal]{vgtc}                % final (journal style)
%\documentclass[review,journal]{vgtc}         % review (journal style)
%\documentclass[widereview]{vgtc}             % wide-spaced review
%\documentclass[preprint,journal]{vgtc}       % preprint (journal style)
%\documentclass[electronic,journal]{vgtc}     % electronic version, journal

%% Uncomment one of the lines above depending on where your paper is
%% in the conference process. ``review'' and ``widereview'' are for review
%% submission, ``preprint'' is for pre-publication, and the final version
%% doesn't use a specific qualifier. Further, ``electronic'' includes
%% hyperreferences for more convenient online viewing.

%% Please use one of the ``review'' options in combination with the
%% assigned online id (see below) ONLY if your paper uses a double blind
%% review process. Some conferences, like IEEE Vis and InfoVis, have NOT
%% in the past.

%% Please note that the use of figures other than the optional teaser is not permitted on the first page
%% of the journal version.  Figures should begin on the second page and be
%% in CMYK or Grey scale format, otherwise, colour shifting may occur
%% during the printing process.  Papers submitted with figures other than the optional teaser on the
%% first page will be refused.

%% These three lines bring in essential packages: ``mathptmx'' for Type 1
%% typefaces, ``graphicx'' for inclusion of EPS figures. and ``times''
%% for proper handling of the times font family.

\usepackage{mathptmx}
\usepackage{graphicx}
\usepackage{times}
\usepackage{epstopdf}
\usepackage[utf8]{inputenc}

%% We encourage the use of mathptmx for consistent usage of times font
%% throughout the proceedings. However, if you encounter conflicts
%% with other math-related packages, you may want to disable it.

%% This turns references into clickable hyperlinks.
\usepackage[bookmarks,backref=true,linkcolor=black]{hyperref} %,colorlinks
\hypersetup{
  pdfauthor = {},
  pdftitle = {},
  pdfsubject = {},
  pdfkeywords = {},
  colorlinks=true,
  linkcolor= black,
  citecolor= black,
  pageanchor=true,
  urlcolor = black,
  plainpages = false,
  linktocpage
}

%% If you are submitting a paper to a conference for review with a double
%% blind reviewing process, please replace the value ``0'' below with your
%% OnlineID. Otherwise, you may safely leave it at ``0''.
\onlineid{0}

%% declare the category of your paper, only shown in review mode
\vgtccategory{Research}

%% allow for this line if you want the electronic option to work properly
\vgtcinsertpkg

%% In preprint mode you may define your own headline.
%\preprinttext{To appear in an IEEE VGTC sponsored conference.}

%% Paper title.

\title{MetroViz: Visual Analysis of Public Transportation Data}

%% This is how authors are specified in the journal style

%% indicate IEEE Member or Student Member in form indicated below
\author{Fan Du, Joshua Brulé, Peter Enns, Varun Manjunatha and Yoav Segev}
\authorfooter{
%% insert punctuation at end of each item
<<<<<<< HEAD
\item F. Du, J. Brulé, V. Manjunatha and Y. Segev are with the University of Maryland, College Park. E-mail: $\left\{fan|jbrule|varunm|segev\right\}$@cs.umd.edu.
\item P. Enns is with University of Maryland Institute for Advanced Computer Studies. E-mail: peter@umiacs.umd.edu.
=======
\item F. Du, J. Brulé, V. Manjunatha and Y Segev are graduate students at the University of Maryland, College Park. E-mail: $\left\{fan|jbrule|varunm|segev\right\}$@cs.umd.edu.
\item P. Enns is affiliated with the University of Maryland Institute for Advanced Computer Studies
. E-mail: peter@umiacs.umd.edu.
>>>>>>> b3ee9bcfbe265026d6f315dd9250e23701f6e134
}

%% Abstract section.
\abstract{
<<<<<<< HEAD
% Motivation\\
Understanding the quality and usage of public transportation resources is important for schedule optimization and resource allocation. Ridership and adherence are two main dimensions for evaluating the quality of service~\cite{camus2005estimation,hammerle2005use}. Using Automatic Vehicle Location (AVL), Automatic Passenger Count (APC), and Global Positioning System (GPS) data, ridership data and adherence data of public transportation can be collected. In this paper, we discuss the development of a visualization tool for exploring public transportation data. 
We present the map view and the route view to help users locate stops in the context of geography and routes information. To convey ridership and adherence information over years, we present a calendar view inspired by the calendar we use in our daily life. The calendar provides an overview of the data, and users can interactively select specific days to explore the trip details in the trip and stop components of the calendar view. 
In the usability testing, four researchers from the Center for Advanced Transportation Technology (CATT), and six Computer Science PhD students from the University of Maryland took part in a study in which they used our tool to explore the bus transit data of Blacksburg, Virginia. The participants were able to use our tool to explore bus stops, bus routes, ridership and adherence data of bus trips.
} % end of abstract
=======
Understanding the quality and usage of public transportation resources is important for schedule optimization and resource allocation. Ridership and adherence are the two main dimensions for evaluating the quality of service \cite{camus2005estimation,hammerle2005use}. Using Automatic Vehicle Location (AVL), Automatic Passenger Count (APC), and Global Positioning System (GPS) data, ridership data and adherence data of public transportation can be collected. In this paper, we discuss the development of a visualization tool for exploring public transportation data. 
We introduce `map view' and `route view' to help users locate stops in the context of geography and route information. To visualize ridership and adherence information over several years, we introduce `calendar view' - a miniaturized calendar that provides an overview of data where users can interactively select specific days to explore individual trips and stops (`trip view' and `stop view').
MetroViz was evaluated via a series of usability tests that included researchers from the Center For Advanced Transportation Technology (CATT) and students from the University of Maryland - College Park in which test participants used the tool to explore three years of bus transit data from Blacksburg, Virginia.
}
>>>>>>> b3ee9bcfbe265026d6f315dd9250e23701f6e134

%% Keywords that describe your work. Will show as 'Index Terms' in journal
%% please capitalize first letter and insert punctuation after last keyword
\keywords{Public transportation, visual analysis, spatio-temporal data}

%% ACM Computing Classification System (CCS). 
%% See <http://www.acm.org/class/1998/> for details.
%% The ``\CCScat'' command takes four arguments.

%%\CCScatlist{ % not used in journal version
%% \CCScat{K.6.1}{Management of Computing and Information Systems}%
%%{Project and People Management}{Life Cycle};
%% \CCScat{K.7.m}{The Computing Profession}{Miscellaneous}{Ethics}
%%}

%% Uncomment below to include a teaser figure.
  \teaser{
  \centering
  \includegraphics[width=16cm]{img/image10}
  \caption{Map view and route view.}
  \label{map_view}
  }
%% Uncomment below to disable the manuscript note
%\renewcommand{\manuscriptnotetxt}{}

%% Copyright space is enabled by default as required by guidelines.
%% It is disabled by the 'review' option or via the following command:
% \nocopyrightspace

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% START OF THE PAPER %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%% The ``\maketitle'' command must be the first command after the
%% ``\begin{document}'' command. It prepares and prints the title block.

%% the only exception to this rule is the \firstsection command
\firstsection{Introduction}

\maketitle

%% \section{Introduction} %for journal use above \firstsection{..} instead
Public transportation follows scheduled routes and timetables, and allows passengers to board and alight at specific stops or stations. Most research regarding AVL, APC and GPS data focuses on developing algorithms to predict the travel time \cite{Lee:2012:HNF:2424321.2424357,Tiesyte2008,Predic2007}, to automatically optimize scheduling \cite{4658140,Yu2007}, and to estimate the quality of service \cite{camus2005estimation,hammerle2005use}. To the best of our knowledge, there is no existing visualization tool to aid service providers in interactively exploring \emph{all} of this data with the same tool to help gain insight using the advantages of their domain knowledge.

There are three technical challenges that we believe are critical to visually analyze the ridership and adherence data of public transportation over time. The first challenge is to design a general data model that can be applied to different public transportation modes. The second challenge is to design the interface to show the stops/stations, routes, trips, ridership and adherence simultaneously. The third challenge is how to process the large-scale time series data and develop an interactive visual analysis tool.

To address these challenges, we have developed MetroViz, an interactive visual analysis tool that helps users explore public transportation data, and evaluate how the public transportation is serving the public. 
We model the public transportation data by separating it into three levels: 1) the stop/station level, 2) the route level and 3) the trip level. As most public transportation modes follow scheduled routes and timetables, and only allow passengers to board and alight at specific stops or stations, our model and tool can be applied to many different public transportation modes.
Based on the three level model, our visual design consists of three views: the map view, the route view and the calendar view.
We present a map and route view to help users locate stops in the context of geography and route information. To convey ridership and adherence information over years, we present a calendar view inspired by Mike Bostock's D3 calendar \cite{d3calendar}. The calendar provides an overview of the data from which users can interactively select specific days to explore the details in the trip and stop components of the calendar view.

<<<<<<< HEAD
In the usability testing, four researchers from the Center for Advanced Transportation Technology (CATT), and six Computer Science PhD students from the University of Maryland took part in a study in which they used our tool to explore the bus transit data of Blacksburg, Virginia. The participants were able to use our tool to explore bus stops, bus routes, ridership and adherence data of bus trips.
=======
In the usability testing, researchers from the Center for Advanced Transportation Technology (CATT), and students from the University of Maryland - College Park took part in a study in which they used our tool to explore the bus transit data of Blacksburg, Virginia. The participants were able to use our tool to explore bus stops, bus routes, ridership and adherence data of bus trips.
>>>>>>> b3ee9bcfbe265026d6f315dd9250e23701f6e134

To the best of our knowledge, our work is the first to help users visually analyze public transportation data, as well as to allow users to interactively explore the large-scale time series ridership and adherence data over time. Our work presents three technical contributions.

\begin{itemize}
  \item \textbf{A general data model} that divides the public transportation data into three levels. This model can be applied to different public transportation modes.
  \item \textbf{An overview-to-detail interface} consists of three views that visualize stops/stations, routes, trips, ridership and adherence data simultaneously.
  \item \textbf{An iterative and progressive visual analysis} that accelerates the query response and enables users to explore the data interactively.
\end{itemize}

Following a review of related work, we describe in detail MetroViz's system design, data processing and visual design of the overview-to-detail interface followed by a description of the usability testing to evaluate the design.

\section{Related Works}

\subsection{Analysis of Public Transportation Data}
Automatic Vehicle Location (AVL), Automatic Passenger Count (APC) and Global Positioning System (GPS) has been used to collect ridership and adherence data - the two main factors for evaluating the quality of service of public transportation.
Rancic et al. \cite{Rancic2008} present a tracking system using AVL data to analyzing city bus transit traffic. 
Chen \cite{5203406} introduces a model to simulate bus operation and passenger demand based on AVL and APC data. 
Camus et al. \cite{camus2005estimation} propose a way to estimation the quality of service based on AVL data. 
Hammerle et al. \cite{hammerle2005use} analyze the AVL and APC data of Chicago Transit Authority to estimate service reliability.
Mai et al. \cite{mai2011visualizing} extend the Marey graph by adding schedule adherence and passenger load information to measure transit performance.
Kimpel et al. \cite{4658140} discuss efforts of using the TriMet APC and AVL data to improve buses scheduling.
Yu and Yang \cite{Yu2007} develop a dynamic holding strategy to optimize the holding strategy.

Public transportation data has also be used to predict the travel time and optimize the route choosing. 
Lee et al. \cite{Lee:2012:HNF:2424321.2424357} introduce a real-time travel time prediction method based on multiple samples of similar historical trajectory. 
Tiesyte and Jensen \cite{Tiesyte2008} propose a method to predict the future movement of a vehicle based on the identification of the most similar historical trajectory. 
Predic et al. \cite{Predic2007} use real-time AVL data and historical data to predict bus motion and bus arrival time. 
Nguyen et al. \cite{Nguyen2012} treat buses as moving objects, and use temporal maps to represent the movements of buses in spatio-temporal domain to help passengers choose appropriate routes. 
Liu et al. \cite{5958130} propose a bus trip planning system to help passengers choose the most appropriate lines and transfers, based on traffic data.

However, most of the research regarding AVL, APC and GPS data focuses on developing algorithms to predict the travel time, to automatically optimize the bus scheduling, or to estimate the quality of service. To the best of our knowledge, there is no existing visual analysis tool that could aid service providers to interactively explore those data and gain insights using the advantages of their domain knowledge.

<<<<<<< HEAD
\subsection{Spatio-temporal Data Visualization}
Transportation data is a kind of spatio-temporal data. Public transportation modes follow scheduled routes and timetables, and allow passengers to board and alight at specific stops or stations. A lot of research regarding spatio-temporal data visualization focus on trajectory drawing. 
Tominski et al.~\cite{Tominski2012} use a hybrid 2D/3D display to show the trajectories and associated attributes in their spatio-temporal context.
Scheepens et al.~\cite{6065019} improve density maps to help explore trajectories using multiple density fields.
Some research use graphs to visualize the spatio-temporal data.
Cui et al.~\cite{4658140} propose an edge-clustering method to reduce edge crossings and visualize geometry graphs.
Guo~\cite{5290710} develops a visualization framework to interactively explore large-scale spatio flows.
Wang and Chi~\cite{6065020} introduce a focus+context method to visualize metro map on small displaying area of mobile devices.

However, trajectories cannot effectively show data in both the spatio-temporal context and the ridership-adherence context simultaneously. In our design, we choose to use an overview-to-detail interface to show stops / stations, routes and trips information on different levels of visualization.
=======
\subsection{Spatial-temporal Data Visualization}
Transportation data is a special case of spatio-temporal data. Public transportation modes follow scheduled routes and timetables, and allow passengers to board and alight at specific stops or stations. Much previous research regarding spatio-temporal data visualization focus on trajectory drawing. 
Tominski et al. \cite{Tominski2012} use a hybrid 2D/3D display to show the trajectories and associated attributes in their spatio-temporal context.
Scheepens et al. \cite{6065019} improve density maps to help explore trajectories using multiple density fields.
Some research focuses on graphs to visualize the spatio-temporal data.
Cui et al. \cite{4658140} propose an edge-clustering method to reduce edge crossings and visualize geometry graphs.
Guo \cite{5290710} develops a visualization framework to interactively explore large-scale spatio flows.
Wang and Chi \cite{6065020} introduce a focus+context method to visualize metro map on small displaying area of mobile devices.

However, trajectories cannot effectively show data in both the spatio-temporal context and the ridership-adherence context simultaneously. In our design, we choose to use separated overview-to-detail interface to show stops/stations, routes and trips information on different levels of visualization.
>>>>>>> b3ee9bcfbe265026d6f315dd9250e23701f6e134

\section{System Overview}
MetroViz is organized into three primary views: map view (Fig. \ref{map_view}), route view (Fig. \ref{map_view}) and calendar view (Fig. \ref{calendar_view_big}). These views are designed to visualize several dimensions of public transportation datasets at different levels of detail, and to allow the user to zoom in on the data they wish to explore and filter out extraneous details.

To begin, the user is presented with a broad overview of the transportation system's organization in space, and routes with two coordinated views (map and route view). In the map view, stops are visualized as blue circles superimposed on a Google map. Mousing over a stop highlights it on both the map and route views and displays the distribution of fare types collected at the stop in a donut glyph around the stop. The route view also displays stops as blue circles. For each route, stops are displayed in linear order that they occur in the actual bus route, followed by the route's name. Mousing over a stop triggers the same response that it would in the map view. Mousing over a route name highlights every stop in the route in both views.

Route view provides two controls to filter data as needed. Clicking on a stop displays all of the data collected at that stop in the calendar view. Similarly, clicking on a route's name displays all of the data collected for the entire route in the calendar view. Calendars in the calendar view are organized in a familiar format. The calendar displays either adherence or ridership for every day where data was collected with the type of data displayed on the calendar controlled via dropdown menu.

The user may drill down further from the calendar by clicking on a specific day. If the calendar was generated by clicking on a stop, the stop component (Fig. \ref{calendar_view_big}) of the calendar view is displayed. Similarly, if the calendar was generated by clicking on a route, the trip component (Fig. \ref{trip_component}) of the calendar view is displayed. Both of these views provide fine grained details about each stop or route throughout the day.

\begin{figure*}[htb]
 \centering
 \includegraphics[width=16cm]{img/image08}
 \caption{Calender view with stop component.}
 \label{calendar_view_big}
\end{figure*}
\section{Data Processing}

In development of MetroViz, we used three years of bus transit data for the city of Blacksburg, Virginia. The data was collected and given to us by the Blacksburg Department of Transportation. The data consists of three files; each file includes about three years of data from mid 2010 to mid 2013. Uncompressed, the files totaled over three gigabytes worth of data.

The first file consists of the buses adherence to schedule. For every bus route, for every trip on that route, and for every stop on that trip, it shows the scheduled departure time from that stop, as well as the actual departure time from that stop, and the difference in seconds between them

The second file has data about the number of passengers on the bus at each stop. For every trip and stop, there are data for the number of passengers buying a ticket (collected by the ticketing machines installed on the bus), the number of passengers boarding and the number of passenger alighting the bus (both collected by an automatic counting device, and generally less reliable than the fare count).

The third file is a breakdown of the fare counts into categories. Categories includes but not limited to: student fare, faculty/staff, full fare, etc.

The first step we took in processing the data, was to write scripts that filter out erroneous records, such as partial records, or records that are inconsistent in any way. After that we used another script to load the files into a Sqlite3 database, and use batch SQL queries to align the data of the first file to that of the second file (passengers count, and adherence data). We also loaded the third file (fares breakdown) to the database, in order to easily run aggregated statistics. Once the data was ready and quality assured, we exported it to a different set of tables used in the visualization process.

In order to supply the data to the visualization utility, we wrote a simple python based web server using the CherryPy framework that returns JSON formatted data to several types of HTTP requests with a given set of parameters (such as data types, dates, routes, etc.)

\section{Visual Design}
\subsection{Map View and Route View}

Map view (Fig. \ref{map_view}) (built on top of Google Maps) is designed to provide an overview the entire Blacksburg bus transit system. Every bus stop in the system appears as a blue dot. Hovering over a stop highlights it in route view (discussed below) and brings up a donut chart summarizing the fare types at that stop.

Map view also includes a search feature to search stops by name. Based on requests from the initial usability study, we added drop-down auto-completion to the search box. Entering a stop will pan/zoom the map to center on the appropriate stop.

The route view (Fig. \ref{map_view}), placed immediately below the map view, is designed to provide a concise overview of all bus stops in the Blacksburg bus transit system. Each stop is represented by a small blue circle, and a single route is represented by an array of stops. The name of the route is located to the right of the last stop. The Blacksburg bus transit system has 25 active routes which cannot all be displayed without the use of a scroll-bar. The scroll-bar ensures that the user can have a simultaneous view of any route as well the map. 

The user can interact with route view via the following actions:
\begin{enumerate}
  \item hovering over individual stops (blue circles)
  \item clicking individual stops 
  \item hovering over individual routes (route name text)
  \item clicking individual routes.
\end{enumerate}

The initial design of route view had each stop circle increase in size on mouse-over. During the usability test, several participants requested highlighting instead. In the current version, the stop receives a red highlight and appears as the center of focus in the map view with a red highlight and fare information. The numeric position of the stop in the route, and the name of the stop appear as tooltips. If several routes share a stop, they all receive red highlights with position and name tooltips, in their respective routes. 

When the user clicks a blue circle representing an individual stop, the calendar view for that particular stop (see section 5.2) is produced to the right of the route view.

When the user hovers over a route name all stops in that route are highlighted in the route view and map view allow the user to quickly geographically visualize the entire route.

When a user clicks the name of a route, the calendar view for that route is generated to the right of the route view.

\subsection{Calendar View}
The calendar view's (Fig. \ref{calendar_view}) basic design is essentially a series of miniaturized monthly calendars stacked vertically. A single year in the calendar view is displayed as a grid with seven columns and enough rows to display 12 months where each cell represents a day. Months are delimited with thick black lines. Multiple years are tiled side by side.

\begin{figure}[htb]
 \centering
 \includegraphics[width=5cm]{img/image02}
 \caption{Calender view.}
 \label{calendar_view}
\end{figure}

Adherence and ridership are visualized in similar ways. For adherence, the color of a day is determined by the average of the absolute value of the difference between the scheduled arrival time and the actual arrival time. For ridership, the color for each day is determined by the average number of passengers who boarded on that day. Less extreme values on each scale (buses arriving close to their scheduled time and low number of passengers) are more blue, and more extreme values (buses arriving very late or early and high numbers of passengers) are more red. Days with missing data are left blank (white).

In the initial usability study, calendar view displayed years horizontally. Several users complained that this was unintuitive and at their suggestion, calendar view was redesigned vertically. Also brought to our attention was the that while the original color scheme (green to red) was arguably more intuitive, it it would be unacceptable for an individual who was color blind. Also, the original color scheme had too many colors, which made it hard to distinguish one from another. We corrected this by changing the color scheme to use a spectrum safe for individuals who are colorblind with only five colors.

\subsubsection{The Trip View Component of Calendar View}
The `trip view' component (Fig. \ref{trip_component}) of calendar view visualizes adherence and ridership for each trip of a route route that occurred on a specific day. Data is displayed on a rectangular grid with rows representing trips and columns representing stops. Each cell contains n squares where n is the number of passengers who boarded at that stop on that trip. The squares are colored according to adherence. Adherence is mapped to a spectrum from dark blue (bus arrived on time) to dark red (bus was very early or late). One of the most important goals of MetroViz was to be able to display the stops, routes, and trips where the most passengers were affected by a bus with poor adherence. Trip view achieves this by attracting the user's eye to large red areas on the grid.

\begin{figure}[htb]
 \centering
 \includegraphics[width=8cm]{img/image07}
 \caption{Trip component of calendar view.}
 \label{trip_component}
\end{figure}

Originally, the trip view displayed stops as circles with different sizes. Our first usability study revealed this to be unsuitable because it was too difficult to compare the sizes of circles. In addition, the original color scheme was inconsistent with the rest of the system and more difficult to use because it was a continuous spectrum. We addressed this problem by using the same color scheme as the calendar view and displaying the passengers as discrete quantities.

Unfortunately, even the improved trip component of calendar view suffers from the quality of the Blacksburg bus system dataset. Many stops report no passengers boarding while others report unrealistic numbers of passengers boarding (sometimes as high as 160 - especially unlikely given that most buses can hold no more than 60 passengers).

\subsubsection{The Stop View Component of Calendar View}
The `stop view' component (Fig. \ref{stop_component}) of calendar view visualizes ridership and adherence of a single stop for a single day. One of the major challenges of stop view was displaying adherence data in a sensible and intuitive fashion at this level of detail. Unlike the other high-level views, we wanted to capture the distinction between earliness and lateness (e.g. a bus leaving 5 minutes earlier than expected may result in a significantly longer wait for the next bus; a bus leaving 5 minutes later than expected is only a 5 minutes wait.) This ruled out the strategy of taking the sum of the absolute value of the deltas between scheduled and actual arrival time as we did for calendar view and trip view. Averaging the deltas is also unsuitable - a bus that was 10 minutes early and and another bus that was 10 minutes late would average out to be exactly on time. In addition, we desired a display that would simultaneously show the number of passenger boardings to visualize the number of people affected by non-adherence.

Stop view went through a number of iterations. The initial design showed the number of boardings and either earliness (in green) or lateness (in red) for every stop that day at a particular location. A variant of this design used the same color scheme, but bucketed stops by hour (the values shown for each hour are the average values for all stops that occurred during that hour) for a more predictable use of space and consistent spacing. Bucketing also had the effect of sometimes showing early (green) and late (red) bars for the same hour.

In the initial usability tests, we also tested versions of the above bar charts with adherence and ridership displayed on separate charts. In addition, there were line chart versions of all of the bar charts.

Most of the initial usability test participants disliked the design choices in the initial bar charts and the line chart versions were universally disliked. The test participants also universally preferred bucketing the stops by hour instead of displaying every stop individually.

The most common complaints were a dislike of different types of data (number of passengers and minutes early/late) displayed on the same scale and the display of both earliness and lateness as positive values on the chart.

We had several suggestions that earliness be displayed as a negative value and lateness be displayed as a positive one. Our first re-design kept the green and red bars separate and simply mirrored the earliness bar over the x-axis. Later, we realized that we could reduce space by stacking the early and late bars on top of each other and with a clear origin line, display the stacked bars as a single color.

This display strategy also has the benefit that the total length of each bar is the same length of a bar displaying the sum of the absolute value of the deltas between scheduled and actual arrival time which helps maintains consistency with calendar and trip component's adherence ranking system. A ridership chart is also shown directly below the adherence chart to help visualize the number of people affected by non-adherence.

\begin{figure}[htb]
 \centering
 \includegraphics[width=8cm]{img/image05}
 \caption{Stop component of calender view.}
 \label{stop_component}
\end{figure}

Finally, we also investigated the possibility of using radar charts to display population or adherence levels as stop time naturally mapped to a clock-like display. However, we found that such a chart makes comparisons between hours difficult and in usability tests was generally rejected in favor of the simple bar chart.

\section{Evaluation}
\subsection{Methodology}
We decided that the best method for evaluating the performance of the MetroViz system was to conduct usability tests on several test subjects as opposed to a more formal controlled experiment - there were no concrete hypotheses to test, nor could we define suitable dependent and independent variables. And although domain experts were amongst our test subjects, the short duration of this project made a long term case study infeasible. Our usability tests involved a training session followed by a set of pre-determined tasks that the test subject were asked to perform. We encourage participants to `think out loud' and give verbal feedback which we recorded during the test session. We also observed if the participant has any undue difficulty in performing the task. As mentioned previously, many of our design choices were based on early usability test suggestions and feedback.

Our usability test had four steps: First, we gave a demonstration of MetroViz individually. Second, we collected some information from the participant to determine if they had any prior domain knowledge on visualizing transportation data. Then, we gave the subject a set of tasks with seven different themes. We would assist the users verbally if they had extreme difficulty in performing a task. Finally, we administered a Likert Scale style questionnaire to obtain more formal feedback. 

The tasks for the Usability Test were: 
\begin{enumerate}
  \item Given a bus-stop, what are the routes this stop is present in. What road in Blacksburg, Virginia is this stop located on ? What are the most common passenger types (whether students, faculty or general public) that use this stop ?
  \item Given the route view, what are the shortest and longest routes in terms of number of stops
  \item Given two routes, what type of passengers mostly use the route
  \item Given a single route, geographically, which part of Blacksburg, Virginia does this route serve
  \item Given a bus stop, on what days was the arrivals at the stop unusually not on schedule ? On what days were an unusually large number of passengers using the stop?
  \item Given a (bus stop, date) pair, what were the peak hours on the day? Was there any serious delay on the day, or was the bus too early at the stop?
  \item Given a (route, date) pair, what are the busiest stops on the route? At what time did bus service begin and retire for the day ? What are the peak hours for the day for that route?
\end{enumerate}

Tasks 1 to 4 test specifically, the map view and route view of MetroViz. We observed if the subject could use the search functionality correctly, if (s)he could scroll up or down the list of routes and navigate through the map geographically. We also tested if the user can make inferences on the types of passengers using the service (e.g. whether student or faculty/staff). 

Tasks 5 to 7 test if the subject is able to correctly interpret the stop and trip components of calendar view, and whether they are adept at reading the calendar. Much of the information related to these questions were color-coded, and we sought feedback on whether our choice of colors was appropriate or not. The user could make inferences like discovering particularly busy stops and routes or routes and stops that are under-utilized as well as discovering routes that are regularly not on schedule, and the number of passengers affected.

Finally, after the usability tests, we administered a Likert Scale style questionnaire. and solicited feedback on the quality of each of the views (map, calendar, route, trip and stop). We also sought opinions on the color schemes we used, and whether there were any features that the users would like added to the system. We ` took note of any part of the system that the user found excessively difficult or frustrating.

The list of tasks for Usability Testing and the feedback questionnaire and provided is available in the appendix. 

Initial usability tests consisted of three members of the CATT lab.

TODO: total number of test subjects and their background

\subsection{Results}

TODO: aggregate results

We gained some valuable insights upon performing two rounds of usability testing. The first round of usability testing was performed with three members of the CATT lab. 

The second round of usability testing, unlike the previous round was performed with both domain experts and non-experts. Our test subjects concurred on several points of feedback and this will be valuable for future revisions to our software. The calendar view scored high on the Likert Scale, but opinions were divided on the other views. Some users liked the color scheme (red for more passengers and non-adherence, blue for fewer passengers and adherence), while others preferred a different color scheme, or a reversal of the color scheme. Some of the suggestions are trivial to implement, but other recommendations, although simple in concept, are tricky to implement. 

Some of the recommendations made were : 
R1: Disable hovers upon clicking any of the stops in the route view and map view, until the user clicks on an empty space. 

R2: Disable clicking while the data is loading. 

R3: The trip component is extremely large, especially if a particular route has many trips per day, necessitating a lot of up and down scrolling. We could divide the trip component into morning, afternoon, evening and night trips to reduce the size of the trip component. Similarly, if the route had several stops (for example, one of the routes had as many as 80 stops), a lot of left-right scrolling is needed. 

R4: Provide month and day-of-the-week labels in the calendar view. 

R5: Ensure all graphs and plots have titles and axis labels.

\section{Discussion and Future Work}
Although 3 gigabytes is not exceptionally large, MetroViz suffers from many of the problems that plague ``big data" - long load times and incomplete and inaccurate data.

Calendar view handles missing data very well - a day without adherence or stop data is displayed as an unobtrusive blank square. Map view virtually ignores missing data - as along as a single fare count by fare type is available, the donut glyphs for each stop can be rendered.

Unfortunately, trip view does not handle missing data as well - during usage we often ran into problems where selecting a single day would bring up a very large number of trips - but with no ridership data available resulting in a large amount of wasted space. In its present form, on the Blacksburg data set, trip view was mostly unsuccessful, but given higher quality data, it may prove worthwhile in the future.

Despite stacking the early and late bars, stop view charts required a large amount of space to get precise readings on adherence and ridership levels - this made simultaneously comparing multiple days impractical on standard screen sizes. Either larger screen sizes or dynamically resizable charts would be needed to mitigate this shortcoming. However, the ability to visualize earliness, lateness and total adherence in a single chart may be worth the cost of extra screen space.

The long load times are somewhat unavoidable - calendar view requires the complete dataset for a stop/route over the entire time span available and preloading data would result in an excessively long startup time. However, a faster server backend may help mitigate some of the problem.

Aggregate selection in calendar view (multiple days / months) and more comprehensive filters would allow for more precise and faster exploration of the data.

Finally, higher quality data would be ideal and would allow for a better evaluation of trip view.

TODO: a bit more conclusion

TODO: Credits and acknowledgments

% \section{Credits}
% Josh - stop view charts, video, proofreading, several sections written... anything else?
%\acknowledgments{
% }

%\bibliographystyle{abbrv}
%%use following if all content of bibtex file should be shown
%\nocite{*}
\bibliography{template}
\end{document}
